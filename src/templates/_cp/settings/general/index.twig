{% extends "salesforce/_cp/settings/_layout" %}
{% import "_includes/forms" as forms %}

{% set configOverrideMessage %}
    <span class="config-override">[Config Override]</span>
{% endset %}

{% set config = craft.app.config.getConfigFromFile('salesforce') %}

{% set content %}
    <input type="hidden" name="action" value="{{ baseActionPath }}/save">
    {{ redirectInput(baseCpPath) }}

    {% set connecitonOptions = {(null): '-- Select Connection --'|t('salesforce')} %}
    {% for connection in craft.salesforce.connections.all %}
        {% set connecitonOptions = connecitonOptions|merge({
            (connection.handle): connection.handle
        }) %}
    {% endfor %}

    {% set connectionOverride = attribute(config, 'defaultConnection') is defined %}
    {{ forms.selectField({
        label: "Default Connection"|t('salesforce'),
        instructions: "The default connection is used when an API request is made without a specified connection." ~ (connectionOverride ? configOverrideMessage : '') |t('salesforce'),
        id: 'defaultConnection',
        name: 'defaultConnection',
        value: settings.defaultConnection,
        options: connecitonOptions,
        required: true
    }) }}

    {% set cacheOptions = {(null): '-- Select Cache --'|t('salesforce')} %}
    {% for key, config in craft.salesforce.cache.all %}
        {% set cacheOptions = cacheOptions|merge({
            (key): key
            }) %}
    {% endfor %}

    {% set cacheOverride = attribute(config, 'defaultCache') is defined %}
    {{ forms.selectField({
        label: "Default Cache"|t('salesforce'),
        instructions: "The default cache is used when an API request is made without a specified cache." ~ (cacheOverride ? configOverrideMessage : '') |t('salesforce'),
        id: 'defaultCache',
        name: 'defaultCache',
        value: settings.defaultCache,
        options: cacheOptions,
        required: true
    }) }}

{% endset %}
